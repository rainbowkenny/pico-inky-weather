"""
Standalone weather display — Pimoroni Pico Inky Pack (296x128)
UK map embedded (correct Mercator proportions, letterboxed). Single file.
"""
import network, urequests, time, gc
from picographics import PicoGraphics, DISPLAY_INKY_PACK
from machine import Pin
import jpegdec

SSID     = "ASUS_E8_2G"
PASSWORD = "Bbdd1003"
BLACK = 0
WHITE = 15

WMO = {
    0:"Clear", 1:"Clear", 2:"P.Cloudy", 3:"Overcast",
    45:"Fog", 48:"Icy Fog",
    51:"Drizzle", 53:"Drizzle", 55:"Drizzle",
    61:"Lt Rain", 63:"Rain", 65:"Hvy Rain",
    71:"Lt Snow", 73:"Snow", 75:"Hvy Snow",
    80:"Showers", 81:"Showers", 82:"Showers",
    95:"Thunder", 96:"Thunder", 99:"Thunder",
}

# Map panel: x=148..295, y=14..127 (148x113px)
# UK drawn at correct Mercator proportions: 44x101px, offset (52,6) within panel
MAP_X, MAP_Y = 148, 14
_X_OFF, _MAP_W = 52, 44
_Y_OFF, _MAP_H = 6, 101
_LON_MIN, _LON_MAX = -6.5, 2.1
_LAT_MIN, _LAT_MAX = 49.8, 60.9

CITY_DOTS = {
    "Aberdeen": (222, 54), "Birmingham": (223, 96), "Brighton": (232, 111),
    "Bristol": (219, 105), "Cambridge": (233, 99), "Cardiff": (216, 105),
    "Coventry": (225, 97), "Derby": (225, 92), "Edinburgh": (216, 65),
    "Exeter": (215, 112), "Glasgow": (211, 65), "Inverness": (211, 51),
    "Ipswich": (239, 100), "Leeds": (225, 84), "Leicester": (227, 95),
    "Liverpool": (217, 88), "London": (232, 105), "Manchester": (221, 87),
    "Milton Keynes": (229, 100), "Newcastle": (224, 73), "Norwich": (239, 95),
    "Nottingham": (227, 92), "Oxford": (226, 103), "Peterborough": (232, 95),
    "Plymouth": (212, 115), "Reading": (228, 105), "Sheffield": (225, 88),
    "Southampton": (226, 110), "Stoke-on-Trent": (222, 91), "Swindon": (224, 104),
}

def latlon_to_dot(lat, lon):
    x = MAP_X + _X_OFF + int((lon - _LON_MIN) / (_LON_MAX - _LON_MIN) * _MAP_W)
    y = MAP_Y + _Y_OFF + int((_LAT_MAX - lat) / (_LAT_MAX - _LAT_MIN) * _MAP_H)
    x = max(MAP_X + _X_OFF, min(MAP_X + _X_OFF + _MAP_W, x))
    y = max(MAP_Y + _Y_OFF, min(MAP_Y + _Y_OFF + _MAP_H, y))
    return x, y

def connect_wifi():
    wlan = network.WLAN(network.STA_IF)
    wlan.active(True)
    if not wlan.isconnected():
        wlan.connect(SSID, PASSWORD)
        deadline = time.time() + 20
        while not wlan.isconnected() and time.time() < deadline:
            time.sleep(0.5)
    return wlan.isconnected()

def get_location():
    gc.collect()
    r = urequests.get("http://ip-api.com/json/?fields=lat,lon,city", timeout=10)
    d = r.json(); r.close(); gc.collect()
    return float(d["lat"]), float(d["lon"]), d["city"]

def get_weather(lat, lon):
    gc.collect()
    url = ("https://api.open-meteo.com/v1/forecast"
           "?latitude={}&longitude={}"
           "&current_weather=true"
           "&daily=temperature_2m_max,temperature_2m_min,weathercode"
           "&forecast_days=2&timezone=auto").format(lat, lon)
    r = urequests.get(url, timeout=15)
    d = r.json(); r.close(); gc.collect()
    return d

def parse_time(wt):
    try:
        if len(wt) >= 16:
            d = wt[8:10].lstrip("0") or "0"
            m = wt[5:7].lstrip("0") or "0"
            return "{}/{} {}:{}".format(d, m, wt[11:13], wt[14:16])
    except Exception:
        pass
    return "--/-- --:--"

def show_error(display, msg):
    display.set_pen(WHITE); display.clear()
    display.set_pen(BLACK); display.set_font("bitmap8")
    display.text("ERROR", 4, 20, scale=2)
    display.set_font("bitmap6")
    display.text(str(msg)[:42], 4, 55, scale=1)
    display.update()

# ===== BUTTONS (A=GPIO12 prev, B=GPIO13 next, C=GPIO14 refresh) =====
# PULL_UP: pressed = value() == 0
_btn_a = Pin(12, Pin.IN, Pin.PULL_UP)
_btn_b = Pin(13, Pin.IN, Pin.PULL_UP)
_btn_c = Pin(14, Pin.IN, Pin.PULL_UP)

def btn_pressed():
    """Return 'a', 'b', 'c', or None (with simple debounce)."""
    if _btn_a.value() == 0:
        time.sleep_ms(50)
        return 'a' if _btn_a.value() == 0 else None
    if _btn_b.value() == 0:
        time.sleep_ms(50)
        return 'b' if _btn_b.value() == 0 else None
    if _btn_c.value() == 0:
        time.sleep_ms(50)
        return 'c' if _btn_c.value() == 0 else None
    return None

# Preset cities: (display_name, lat, lon)  — None = auto geolocation
PRESET_CITIES = [
    (None,          None,    None  ),   # 0: Auto
    ("London",     51.509, -0.118  ),
    ("Cambridge",  52.205,  0.122  ),
    ("Manchester", 53.481, -2.243  ),
    ("Edinburgh",  55.953, -3.188  ),
    ("Birmingham", 52.486, -1.890  ),
    ("Glasgow",    55.862, -4.258  ),
    ("Leeds",      53.801, -1.549  ),
    ("Bristol",    51.454, -2.588  ),
    ("Newcastle",  54.978, -1.618  ),
]
_CITY_FILE = "city_idx.txt"

def load_city_idx():
    try:
        with open(_CITY_FILE) as f:
            v = int(f.read().strip())
            return v if 0 <= v < len(PRESET_CITIES) else 0
    except Exception:
        return 0

def save_city_idx(idx):
    try:
        with open(_CITY_FILE, "w") as f:
            f.write(str(idx))
    except Exception:
        pass

UK_MAP = (
    b'\xff\xd8\xff\xe0\x00\x10JFIF\x00\x01\x01\x00\x00\x01\x00\x01\x00\x00'
    b'\xff\xdb\x00C\x00\x03\x02\x02\x02\x02\x02\x03\x02\x02\x02\x03\x03\x03\x03\x04'
    b'\x06\x04\x04\x04\x04\x04\x08\x06\x06\x05\x06\t\x08\n\n\t\x08\t\t\n'
    b'\x0c\x0f\x0c\n\x0b\x0e\x0b\t\t\r\x11\r\x0e\x0f\x10\x10\x11\x10\n\x0c'
    b'\x12\x13\x12\x10\x13\x0f\x10\x10\x10\xff\xc0\x00\x0b\x08\x00q\x00\x94\x01\x01'
    b'\x11\x00\xff\xc4\x00\x1f\x00\x00\x01\x05\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00'
    b'\x00\x00\x00\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\xff\xc4\x00\xb5\x10'
    b'\x00\x02\x01\x03\x03\x02\x04\x03\x05\x05\x04\x04\x00\x00\x01}\x01\x02\x03\x00'
    b'\x04\x11\x05\x12!1A\x06\x13Qa\x07"q\x142\x81\x91\xa1\x08'
    b'#B\xb1\xc1\x15R\xd1\xf0$3br\x82\t\n\x16\x17\x18\x19\x1a'
    b"%&'()*456789:CDEFGHI"
    b'JSTUVWXYZcdefghijstu'
    b'vwxyz\x83\x84\x85\x86\x87\x88\x89\x8a\x92\x93\x94\x95\x96\x97\x98'
    b'\x99\x9a\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba'
    b'\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xe1\xe2'
    b'\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xff\xda'
    b'\x00\x08\x01\x01\x00\x00?\x00\xfa\xcf\xf6d\xfd\x99?f\xdd\x7f\xf6m'
    b'\xf8Q\xae\xeb\xbf\xb3\xe7\xc3]GR\xd4|\x0f\xa1]\xde^]\xf8'
    b'N\xc2i\xeeg\x92\xc2\x16\x92Y$h\x8b;\xb3\x12\xc5\x89$\x92'
    b'I\xafK\xff\x00\x86N\xfd\x96?\xe8\xda~\x15\x7f\xe1\x1b\xa7\x7f\xf1'
    b'\x9a?\xe1\x93\xbfe\x8f\xfa6\x9f\x85_\xf8F\xe9\xdf\xfcf\x8f\xf8'
    b'd\xef\xd9c\xfe\x8d\xa7\xe1W\xfe\x11\xbaw\xff\x00\x19\xa3\xfe\x19;'
    b'\xf6X\xff\x00\xa3i\xf8U\xff\x00\x84n\x9d\xff\x00\xc6h\xff\x00\x86'
    b'N\xfd\x96?\xe8\xda~\x15\x7f\xe1\x1b\xa7\x7f\xf1\x9a?\xe1\x93\xbfe'
    b'\x8f\xfa6\x9f\x85_\xf8F\xe9\xdf\xfcf\x8f\xf8d\xef\xd9c\xfe\x8d'
    b'\xa7\xe1W\xfe\x11\xbaw\xff\x00\x19\xa3\xfe\x19;\xf6X\xff\x00\xa3i'
    b'\xf8U\xff\x00\x84n\x9d\xff\x00\xc6j\xa6\xad\xfb2~\xc8\x9a\x06\x95'
    b'{\xae\xeb\xbf\xb3\xe7\xc1\xfd;M\xd3\xad\xe4\xbb\xbc\xbc\xbb\xf0\x9e\x99'
    b'\x0c\x16\xd0F\xa5\xa4\x96I\x1a \xa8\x8a\xa0\xb1b@\x00\x12k\x9f'
    b'\xf8[\xf0\x83\xf6\x1d\xf8\xd3\xe0M3\xe2g\xc3O\x80\xdf\n\xb5\x9f'
    b'\r\xeb>w\xd8\xaf\x7f\xe1\x03\xb4\xb7\xf3|\xa9\x9e\x19?w5\xb2'
    b"H\xb8\x92'_\x99Fq\x91\x90A=_\xfc2w\xec\xb1\xff\x00"
    b'F\xd3\xf0\xab\xff\x00\x08\xdd;\xff\x00\x8c\xd1\xff\x00\x0c\x9d\xfb,\x7f'
    b"\xd1\xb4\xfc*\xff\x00\xc27N\xff\x00\xe34\x7f\xc3'~\xcb\x1f\xf4"
    b'm?\n\xbf\xf0\x8d\xd3\xbf\xf8\xcd\x1f\xf0\xc9\xdf\xb2\xc7\xfd\x1bO\xc2'
    b'\xaf\xfc#t\xef\xfe3G\xfc2w\xec\xb1\xff\x00F\xd3\xf0\xab\xff'
    b'\x00\x08\xdd;\xff\x00\x8c\xd1\xff\x00\x0c\x9d\xfb,\x7f\xd1\xb4\xfc*\xff'
    b"\x00\xc27N\xff\x00\xe34\x7f\xc3'~\xcb\x1f\xf4m?\n\xbf\xf0"
    b'\x8d\xd3\xbf\xf8\xcd~E\xff\x00\xc1]\xbe\x1e\xf8\x07\xe1\xaf\xed%\xe1'
    b'\xbd\x0b\xe1\xcf\x81\xfc?\xe1]6\x7f\x03\xd9\xdd\xcbg\xa2i\x90\xd8'
    b'\xc1$\xed\x7f~\xad+G\n\xaa\x97*\x88\xa5\x88\xce\x11Ga_'
    b"\xae\x9f\xb2w\xfc\x9a\xc7\xc1\xbf\xfb'\xfe\x1e\xff\x00\xd3t\x15\xea\xb4"
    b'QE\x14QE|Q\xff\x00\x05\\\xf0\xa7\xc6\x1f\x15\xfe\xcfv\xd0'
    b'\xfc>\xb5\xd35/\r\xda\xea1\x0f\x10h\xe6K\xff\x00\xed-Z'
    b'\xe6\xe6hl\xb4\xc8-"\xb5!n\x02]]\x89\xccR\x9c\x19m'
    b'\xedHW\xda\xd1\xbf\xd9\x9aN\x93\xa5h\x1aU\x96\x85\xa1i\x96\x9a'
    b'v\x9b\xa7[\xc7iggi\n\xc3\x05\xb4\x11\xa8X\xe2\x8e5\x01'
    b'Q\x15@P\xa0\x00\x00\x00U\xba(\xa2\x8a(\xaf\xc5o\xf8-_'
    b'\xfc\x9d?\x85\xbf\xec\x9f\xd8\xff\x00\xe9\xc7Q\xaf\xd5O\xd9;\xfeM'
    b'c\xe0\xdf\xfd\x93\xff\x00\x0f\x7f\xe9\xba\n\xf5Z(\xa2\x8a(\xaf\x9f'
    b'\xff\x00j\xdf\xda\xc6\xcf\xf6i\xff\x00\x84[I\xb5\xf0\xce\x95\xaex'
    b'\x83\xc5\xdfn\x93M\xb5\xd6|M\x07\x87\xecd\x8e\xcf\xc8\xf3\xd4\xdf'
    b'\xdc#C\x14\xd8\xb9GE\x98\xc7\x1b\xacr\x81/\x9b\xe4\xc37\xb5'
    b'xOQ\xd7u\x8f\n\xe8\xda\xb7\x8a|9\xff\x00\x08\xfe\xb5{\xa7'
    b'\xdb\xdcj:G\xdb\x12\xef\xfb>\xe9\xe3V\x96\xdb\xcf@\x12_-'
    b"\xcb'\x98\xa3km\xc8\xe0\xd6\xb5\x14QE\x14Q_\x8a\xdf\xf0Z"
    b'\xbf\xf9:\x7f\x0b\x7f\xd9?\xb1\xff\x00\xd3\x8e\xa3_\xaa\x9f\xb2w\xfc'
    b"\x9a\xc7\xc1\xbf\xfb'\xfe\x1e\xff\x00\xd3t\x15\xea\xb4QE\x15\xf3\xb6"
    b"\x91\xfbP_|@\xfd\xa4\xac>\x0f|3\xb6\xd3'\xd1\xf4k\xcd"
    b'Z\xdb\xc5\r\xa8[\xcd\x1e\xa1,\x16Q\xc9\x0c\xf7\xb6a\x9a4['
    b'Xu#kc\xe6\x15\x94\xdcJ\xf7~Z\xa2Y\xb4\xd2Q\xd7>'
    b'=|P\xf1\xbf\xc5\x0f\x11\xf8o\xe0\x96\xb5\xe1\xbb\x0f\x0cxV\xde'
    b'+\x1b\xbdO\xc4^\x08\xd5.E\xde\xb6\x97\xb7\xf6\xd7\xd6\xd6\xf3\x1b'
    b'\xbb8\xe4K\x7f\xb2B\x19\xa2\x12\xae\xe9H\xdf\xc6+\xcb\xac>\x0b'
    b'\xc3\xfbI~\xd3\x9e\x03\xf8\xb5\xe2\xef\x16X\xf8\xdfR\xf8U\xaa\xca'
    b'\xfa\xe5\xce\x8f\xa7\xdb\xe9\xba.\x99-\xbaJmt\xf8\x9e#%\xe4'
    b'\xb7\x91\xdf\x0bk\x96\xb6\x9e\xf2t\x85V\xe5\x9c@\xb7PC7\xdd'
    b'\x14QE\x14QE\x15\xf8\xad\xff\x00\x05\xab\xff\x00\x93\xa7\xf0\xb7\xfd'
    b"\x93\xfb\x1f\xfd8\xea5\xfa\xa9\xfb'\x7f\xc9\xac|\x1b\xff\x00\xb2\x7f"
    b'\xe1\xef\xfd7A^\xabE\x14Q_\x9b\x9f\x1e>4\xe9_\xb0\xef'
    b'\xed\r\xe3_\x15\xc3\xf0\xd2\xd2\xc3]\xf1\xbd\xa6\xa5{o\xe3\x7f\x15'
    b'\xb5\xfe\xb7s\xe2\xb0\xdau\xdd\xd5\xad\xa5\xa4\x90\xb2E\xa6\xdbY\xea'
    b'1\xe9\xda{\xda\xe0\xb4\x96\xf2ZH\xc65\x89e>\xcf\xfb?\xf8'
    b'w\xc3\x9a\x0f\xc2o\x0f\xddxcR\xd4\xf5\x1bo\x10\xd9\xc3\xe2\t'
    b'\xafu\rf\xefS\x96\xf2\xe6\xf25\x9ak\x9f:\xe9Q\xf3,\x8e'
    b'\xd2\xb6"\x843\xc8\xeeb\x8d\x9d\x85V\xf85\xa7\xfe\xd3\x1f\x0b~'
    b'\x18\xf8\x7f\xe1\xfe\x99\xe3o\x87Z}\xa6\x89lm\xe1\xb2\xbd\xd15'
    b'_\x105\xaa\xeff\x10\xc5{&\xa3j\xefn\x9b\xb6\xc1\x1b\xc3\xba'
    b'\x18V(ZI\xccFy=?\xe0\xa7\xc5\x0f\x8c~%\xf8\x9f\xaf'
    b'\xf8\x0b\xc6\xf6\xde\x1f\xd7\xf4\x8d\x1fJ\x86\xea\xe7\xc4z\x0e\x8f&\x95'
    b'k\xa7\xea2:\x98\xf4\xc7I\xaf\xae\x9e\xe2\xe1\xe0o\xb40_+'
    b'\xc8\x8f\xc8-\xbf\xedq\x94\xf7j(\xa2\x8a(\xa2\xbf\x15\xbf\xe0\xb5'
    b'\x7f\xf2t\xfe\x16\xff\x00\xb2\x7fc\xff\x00\xa7\x1dF\xbfU?d\xef'
    b'\xf95\x8f\x83\x7f\xf6O\xfc=\xff\x00\xa6\xe8+\xd5h\xa2\x8a+\xf3'
    b'\xf3\xfe\n\xb5\xf1\x19\xb4\x8f\x0ei\x9f\x0c\xfcQ\xf0\xe7\xed>\x19\xf1'
    b'F\x9f \xb7\xf1#x\xf8\xd8\xad\xbc\xf1\xc8g\xbb\xff\x00\x89\n]'
    b'[\x7fjKo\r\xb42\xc2g\x7f(\\Oo\x18\xcb\xc9\xe5\xcb'
    b'\xe9\x1f\x04<C\xae\xf8\x8f\xc2\xda\x94\xda\xa7\x82\xb4\xdf\x08i\xdaV'
    b'\xbb\xa8h\x1a&\x87j\xe8\xd2\xd8Yi\xd3\x1b\x13\x15\xc7\x94L\x0b'
    b'(\xb8\xb6\xb9\xc2\xc0\xcd\x12\xc6bUw\xc1c/\xc5\xef\x8d\xff\x00'
    b'\x0f~\x08h\x89\xacx\xe3Q\xb9\xf3\xae`\xbc\x9e\xc7M\xb0\xb5{'
    b'\xab\xeb\xe1kn\xf7\x13\xf9Q $*F\x84\xbc\xaeV(\xf2\xa6'
    b'G@A\xafy\xf8%\xf0\xf2\xfb\xe1\xbf\x80-t\xcf\x10Miu'
    b'\xe2}RY5\x8f\x12\xde[1x\xae5[\x82\x1aa\x1c\x8e\xab'
    b'#\xdb\xc5\xf2\xdb\xdb\xf9\x80\xba[[\xdb\xc6I\xf2\xc5w\xb4QE'
    b'\x14QE~+\x7f\xc1j\xff\x00\xe4\xe9\xfc-\xff\x00d\xfe\xc7\xff'
    b'\x00N:\x8d~\xaa~\xc9\xdf\xf2k\x1f\x06\xff\x00\xec\x9f\xf8{\xff'
    b'\x00M\xd0W\xaa\xd1E\x14W\xcb\xff\x00\xb6\x8f\x8d~<\xe9Z\xaf'
    b'\xc3\xcf\x87?\n\xad\xee\xf4\x8f\x07\xf8\xd2\xe2\xfa/\x88^6\xb4O'
    b'\xb3\xcf\xe1=\x12\xdd\xadd\xb8\xbb\x8fP\x91\x85\xb5\x83\xfd\x95\xaf\x88'
    b'\x96ef\xccc\xca\xc4\x8a\xb5\xf0\x7f\xec\x13\xaex\xd3]\xf1?\x81'
    b'|Qy\xf1\xd2\xee\xea\xc5\xac.<3\xaa\xf8i\xf4\x8bR\x90\x88'
    b'md\x1a5\x97\x9f\x14\xac\xfb\x1a\r7R\xb9C$q4/g'
    b"s\x95\xc6\xa4\xb3]}U\xf1'\xf6n\xd6>!\xf8\xbfI\xd4\x9f"
    b'\xe3g\x8a-|)k=\xf5\xc6\xa1\xe1;\xbb+\rWO\xbbk'
    b'\x80\x19F\xcb\xd8e\x8d\xd5&\x06UK\xa8\xee\x96#\xb5m\xc5\xb0'
    b'D\xdb\xef\xff\x00\x08~&\xf8\xa6\xdf]\x9b\xe1\xb7\xc5\xcdj\xca\xf3'
    b'T\xba\x9c\x9f\nk1X\x8bU\xd6\xac\xe3\xb7Vx.6\xb9\x8f'
    b'\xfbM\x0cw\x12\xc8\x91\xa41\xcb\x0e%\x820"\xb9\x8e\xdf\xd9\xe8'
    b'\xa2\x8a(\xa2\x8a\xfcV\xff\x00\x82\xd5\xff\x00\xc9\xd3\xf8[\xfe\xc9\xfd'
    b'\x8f\xfe\x9cu\x1a\xfdT\xfd\x93\xbf\xe4\xd6>\r\xff\x00\xd9?\xf0\xf7'
    b'\xfe\x9b\xa0\xafU\xa2\x8a(\xaf\x87\x9a\xc3\xc5^&\xd3\xbe |L'
    b'\xd5|o\xe2\x9d{R\x8b\xc6>%\xb7:\x16\xa1\xa8\xde\\\xe8W'
    b':.\x9d\xaa\xdcX\xb6\x8d\xfd\x8f\x02\xbd\xb3\xc5qch\xf03\x9b'
    b'K\x89\xc4\x97/:\x89e\x08\xb5cE\xf1\x7f\x89|{\xe2\xff\x00'
    b'\x0c|M\xf8k\xf0{W\xf1o\xc3\xcdG\xc10E\xf0\xde\xdf\xc2'
    b'0i6\xb6\xbe\x1e\xd3H\xb5\xfe\xd3\xb2\xbf\x96k\xf8\xa1K\xef\xb5'
    b'Em\x17\xd9\x94\x14\x8e+\x05\x10\xb38\xbc\t\xa9\xe0\xff\x00\x1f\xfc'
    b']\xd7~!j~\x11\xf17\xc2\r+\xc3V\x1a:$\xb7\xf3K'
    b'\xe2\xb4\xbd\xbe\xb4\xf3\x9a\xe3\xec\xf6\xf2\xc3mn\xf6\xc2\xec\xc5\r\xb5'
    b'\xc4\x90\x0b\xb6\xf2\xe1\xbf\xb6}\xce\\-l\xfcE\xbf\x97\xc2\xda\x97'
    b"\x81\xbe&\xa6\x97\xa9j\x91x'\xc5V\xd7\xf7V\x1au\x8c\xf7w"
    b'\x13Z\xdd\xc1q\xa5\xcf"G\x02I+}\x9e-JK\xa2\xa9\x1b'
    b'\xb3\x8bb\x80.\xfd\xeb\xf4\xb7\x85\xbcY\xe1_\x1c\xe8V\xbe)\xf0'
    b'W\x89\xb4\xaf\x10h\xb7\xbb\xfe\xcd\xa8\xe9w\xb1\xdd\xda\xcf\xb1\xd9\x1f'
    b'd\xb1\x96F\xda\xe8\xcapxe \xf2\rkQE\x14QE~'
    b'+\x7f\xc1j\xff\x00\xe4\xe9\xfc-\xff\x00d\xfe\xc7\xff\x00N:\x8d'
    b'~\xaa~\xc9\xdf\xf2k\x1f\x06\xff\x00\xec\x9f\xf8{\xff\x00M\xd0W'
    b'\xaa\xd1E\x14W\xc9\x9e2\xfd\x9d?i=\x0f\xc6>,\xb3\xf8\x05'
    b'\xe3\x1f\x01\xe9>\x10\xf1\xb6\xbb\xfd\xbc\xf7\x9e mB\xefQ\xf0\xdc'
    b'\xd7j\xc3T\xfb\x1d\xa9\xdf\x05\xc6\xfb\x8f\xf4\xd8\x95\xe4\x86%\x96k'
    b'\x88\xda2\x8c\xae\xbfD|*\xf8g\xe1_\x83\x7f\x0e<9\xf0\xb7'
    b'\xc1V\x9fg\xd1|3\xa7\xc5\xa7\xdbn\x8e4\x92m\x83\xe7\x9e_'
    b'-\x11\x1ai\\\xb4\x928Q\xbeGv#,k\xc1\xff\x00i{'
    b'5\xf8=\xe2\xbf\x0f|D\xf0v\xb95\xb5\xff\x00\xc5\x0f\x1c\xe8\xde'
    b'\x1e\xd5t{\xe5\xb6}2\xeeY \x11\xcdz%\x96H\xa6\xb7\xba'
    b'\x16:zG\x18Ie\x89\xde(\xe3\x16\xaf,\xe6a\xd5\xd7\x19\xf0'
    b'g\xe3\x0f\x80\xf4\x8f\xda+\xfe\x14\xb7\x84>#xj\xea\xd3\xc4Z'
    b'v\xb9\xaa_\xe80\xea\xd0M.\x9f\xaf\xda\\\xday\x89\x04J\xfb'
    b'\xa0\x92\xe1./\xa6\x9e\x0c\x10\xcfh\xf3*\xa3\x9b\xa7\x9b\xea\xba('
    b'\xa2\x8a(\xaf\xc5o\xf8-_\xfc\x9d?\x85\xbf\xec\x9f\xd8\xff\x00\xe9'
    b'\xc7Q\xaf\xd5O\xd9;\xfeMc\xe0\xdf\xfd\x93\xff\x00\x0f\x7f\xe9\xba'
    b'\n\xf5Z(\xa2\x8a+\xe7\x1f\xdb\xbf\xe2o\x8d\xfe\x16|\x1e\xd2u'
    b'o\x86\xbf\x10\xee\xfc+\xe2\xadc\xc5\x16\x1a\x0e\x8e\x96\xba(\xd4\xa4'
    b'\xd5n\xae\xd2h\xe3\xb5\xd8mn\x8a*\x12.\x9bd-$\x8bf'
    b'\xd0G\xb5\xe7V\x1eU\xe2=\x1f\xe3\xcf\xc7\xc8<\x11\xf1:\xd3\xf6'
    b"\x92\xf0\xfd\xbe\x9f\xa7\\Xx\x9b\xc3\xd6\xbag\xc3\xff\x00'M\xb8"
    b'I-.\xe3yg\x8a\xe6\xeeK\xc6y\xad\xaf\x84|\\D\xb1\xa0'
    b'lG\xe6\x91"{]yg\xed\x01\xad\xf8{\xc0\x1e\x1f\xd3\xbe1'
    b'\xdc5\x8e\x9d\xe2o\x04\xdcKs\xe1\xcdv\xf6\xd8\xbd\xb6\x9bq4'
    b'\x0f\x1c\xa2\xed\xc2\x92\xb6r\xc4^9\x91\x7f{(dK`\xd7\x86'
    b'\xd1O\xd0^\r\xfd\xa1\xfe\x16\xf8\xeb\xc46\xde\x15\xd1\xaf|Cg'
    b'\xa9^\x89>\xc9\x1e\xb9\xe1M[EK\xb7D.\xd1C%\xf5\xb4'
    b'),\xa25\x92O)\x18\xbe\xc8\xa5}\xbbcv_I\xa2\x8a('
    b'\xa2\xbf\x15\xbf\xe0\xb5\x7f\xf2t\xfe\x16\xff\x00\xb2\x7fc\xff\x00\xa7\x1d'
    b'F\xbfU?d\xef\xf95\x8f\x83\x7f\xf6O\xfc=\xff\x00\xa6\xe8+'
    b'\xd5h\xa2\x8a(\xaf0\xf8\x81\xf1\xe3A\xf0\xb6\xadq\xe0\xbf\x07i'
    b'\xdf\xf0\x9ax\xce\xdbj\xdd\xe8\xbau\xf4\x11\xae\x90$\x8dZ\x19\xb5'
    b'9\x99\xbf\xd0\xe1}\xf1\x90\x02Iq"\x17x`\x9cE&\xdf*'
    b'\xf8I\xe1=G\xc0_\n|\x19\xe0mbki\xaf\xfc;\xe1\xed'
    b';I\xba\x92\xd9\x99\xa1y\xad\xed\xa3\x89\xd9\x0b\x05b\xa5\x90\x90J'
    b'\x83\x8cd\x0e\x95\xd6Q\\\x0f\x8c,\xbc;\xe3\xcf\x8a\x9f\x0b\xfe\x18'
    b'\xdc-\x8d\xfd\xfc>*\xb3\xf1]\xe4\x11\x08\xe5\xd44\x9bM:\x1b'
    b'\xab\xbb}AT\xeeh!{\xdb[k7\x9c\xae\xd6K\xb9!V'
    b'W\x95H\xfa\xda\x8a(\xa2\x8a\xfcV\xff\x00\x82\xd5\xff\x00\xc9\xd3\xf8'
    b'[\xfe\xc9\xfd\x8f\xfe\x9cu\x1a\xfdT\xfd\x93\xbf\xe4\xd6>\r\xff\x00'
    b"\xd9?\xf0\xf7\xfe\x9b\xa0\xafU\xa2\x8a(\xa2\xbc'\xe3O\xc0O\x83"
    b'\xf2i\xde;\xf8\xab\xe2\xbf\x17x\xe3\xc2\x16\x97Ze\xce\xb3\xe2K'
    b'\xff\x00\x0fx\x93P\xb4\xd9%\xad\x8aD\x9a\x92\xc7\x031\x13[\xdb'
    b'[\xe0G\x1a\xf9R\xfc\xa6hn\x1a8L\x7f<\xeb~2\xf8\xd9'
    b'u5\xa7\xc3\x0f\x00^x\x82\xc3U\xd5\xe5\xf2\xbf\xb7\xfce\xe0\xe9'
    b'./\xb4X\xd9\x1d\xe57R\xe9\xf1\xae\x891X\xd4\xcb\x04\xf0\\'
    b'\xbe\xe9$\xb6\xb4\x9a\xd07\x9ft\x9e\xe5\xe1\xbd\x17\xfe\x11\xbf\x0e\xe9'
    b'^\x1d\xfe\xd6\xd4\xb5O\xec\xbb(,\xbe\xdd\xa9O\xe7\xdd\xddyQ'
    b'\x84\xf3g\x93\x03|\xad\xb7s6\x06X\x93\x81\x9a\xb3\xa9G\xa8\xcb'
    b'\xa7]E\xa3\xdd[Z\xdf\xbc\x0e\xb6\xb3\xdc\xdb\xb4\xf0\xc51S\xb1'
    b'\xde5ti\x146\tP\xe8H\x04\x06\\\xe4y\xdf\xecW\xa8\xf8'
    b'\xe3\xc3\x1f\x10\xbcW\xf0\xdf\xe2\x1e\x83\xe0\xadc\xc5\xfa\xaa^\xf8\x97'
    b'\xc5\x1e)\xf0\xd6\xab\xf6\xa9l\xe470\x9d?J\xbb\x8d\xacb\x9e'
    b'\x18\xbe\xcfy1\xb4\x17W7\x12yv\xf3\x88\xc8\x89U#\xfb\x16'
    b'\x8a(\xa2\x8a\xfcV\xff\x00\x82\xd5\xff\x00\xc9\xd3\xf8[\xfe\xc9\xfd\x8f'
    b'\xfe\x9cu\x1a\xfdT\xfd\x93\xbf\xe4\xd6>\r\xff\x00\xd9?\xf0\xf7\xfe'
    b'\x9b\xa0\xafU\xa2\x8a(\xa2\xbe*\xf8\xd7\xf1\x9a\xd7\xe3\x07\xc5\x1f\n'
    b'h^\x1e\xf8M\xafx\xe3\xc2\x1e\x0f\xbc\xb5\xf1.\x8bs\xa2i\xe3'
    b'P\x9f[\xd6fi\xacl\xeeQO\xfa=\x9e\x99\nK{2_'
    b'^\xcbl\xb3\xc9\x0cr\xda\xbb\xc5\x03I.\xef\x854\xdf\x88\x1f\xb4'
    b'l\xbe$\xba\xf8w\xe3\xedg\xc0>\x12\xd2\xec\xbe\xc1\xa6kM\xe1'
    b'3\x1e\xa1q\xe28\xe7\xbb\x86\xee\x19`\xd5#\x05\xad-Lv\xe2'
    b'DX\x11\xa4\x95\x9e5\xb9\x8d\xa1\x9a:\x87\xc7\xff\x00\xb1\xc7\xed#'
    b'\xf1\x07J\xd6,&\xfd\xb5\xee\xfc8u+\x8b6\xb7\x8b\xc3~\x08'
    b'\x8a\xc6\x0b8"V\xf3Qd\xfb[\xdeo\x92E\x85\xf7\x8b\xa5\n'
    b"\x04\xc8U\xd6@#\xf4\xbd'\xf6C\xf0.\x9d\xa3\xd9Y^|D"
    b'\xf8\xa9\xaajv\xb1Gm.\xb1w\xe3{\xe5\xb8\xba\xb7\\#G'
    b'$\x10\xbaZ\x06h\x01\x84\xcd\x1c\t?&e\x91nqp=G'
    b"\xc0\xdf\x0f<\x13\xf0\xd3F}\x07\xc0\xbe\x1b\xb2\xd1\xed'\x9c\xdd\xdd"
    b'\x18\x10\x99\xafn\x99\x15^\xea\xe6f\xcc\x977\x0e\x117\xcf+<'
    b'\xaeF]\x98\xf3]\x15\x14QE\x15\xf8\xad\xff\x00\x05\xab\xff\x00\x93'
    b"\xa7\xf0\xb7\xfd\x93\xfb\x1f\xfd8\xea5\xfa\xa9\xfb'\x7f\xc9\xac|\x1b"
    b'\xff\x00\xb2\x7f\xe1\xef\xfd7A^\xabE\x14QEr\x9e\x05\xf8O'
    b'\xf0\xb3\xe1\x7f\xdb\xbf\xe1Y\xfc4\xf0\xa7\x84\xbf\xb4\xfc\xaf\xb6\xff\x00'
    b'ah\xd6\xd6\x1fj\xf2\xf7y~o\x92\x8b\xbfo\x98\xfbwg\x1b'
    b'\xdb\x1dMutQE\x14QE\x14W\xe2\xb7\xfc\x16\xaf\xfeN\x9f'
    b'\xc2\xdf\xf6O\xec\x7f\xf4\xe3\xa8\xd7\xc0\x14QE\x14QE\x14QE'
    b'\x14QE\x14Q_\xff\xd9'
)*456789:CDEFGHI"
    b'JSTUVWXYZcdefghijstu'
    b'vwxyz\x83\x84\x85\x86\x87\x88\x89\x8a\x92\x93\x94\x95\x96\x97\x98'
    b'\x99\x9a\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba'
    b'\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xe1\xe2'
    b'\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xff\xda'
    b'\x00\x08\x01\x01\x00\x00?\x00\xfa\xcf\xf6d\xfd\x99?f\xdd\x7f\xf6m'
    b'\xf8Q\xae\xeb\xbf\xb3\xe7\xc3]GR\xd4|\x0f\xa1]\xde^]\xf8'
    b'N\xc2i\xeeg\x92\xc2\x16\x92Y$h\x8b;\xb3\x12\xc5\x89$\x92'
    b'I\xafK\xff\x00\x86N\xfd\x96?\xe8\xda~\x15\x7f\xe1\x1b\xa7\x7f\xf1'
    b'\x9a?\xe1\x93\xbfe\x8f\xfa6\x9f\x85_\xf8F\xe9\xdf\xfcf\x8f\xf8'
    b'd\xef\xd9c\xfe\x8d\xa7\xe1W\xfe\x11\xbaw\xff\x00\x19\xa3\xfe\x19;'
    b'\xf6X\xff\x00\xa3i\xf8U\xff\x00\x84n\x9d\xff\x00\xc6h\xff\x00\x86'
    b'N\xfd\x96?\xe8\xda~\x15\x7f\xe1\x1b\xa7\x7f\xf1\x9a?\xe1\x93\xbfe'
    b'\x8f\xfa6\x9f\x85_\xf8F\xe9\xdf\xfcf\x8f\xf8d\xef\xd9c\xfe\x8d'
    b'\xa7\xe1W\xfe\x11\xbaw\xff\x00\x19\xa3\xfe\x19;\xf6X\xff\x00\xa3i'
    b'\xf8U\xff\x00\x84n\x9d\xff\x00\xc6h\xff\x00\x86N\xfd\x96?\xe8\xda'
    b'~\x15\x7f\xe1\x1b\xa7\x7f\xf1\x9a?\xe1\x93\xbfe\x8f\xfa6\x9f\x85_'
    b'\xf8F\xe9\xdf\xfcf\x8f\xf8d\xef\xd9c\xfe\x8d\xa7\xe1W\xfe\x11\xba'
    b'w\xff\x00\x19\xa3\xfe\x19;\xf6X\xff\x00\xa3i\xf8U\xff\x00\x84n'
    b'\x9d\xff\x00\xc6h\xff\x00\x86N\xfd\x96?\xe8\xda~\x15\x7f\xe1\x1b\xa7'
    b'\x7f\xf1\x9a?\xe1\x93\xbfe\x8f\xfa6\x9f\x85_\xf8F\xe9\xdf\xfcf'
    b'\x8f\xf8d\xef\xd9c\xfe\x8d\xa7\xe1W\xfe\x11\xbaw\xff\x00\x19\xa3\xfe'
    b'\x19;\xf6X\xff\x00\xa3i\xf8U\xff\x00\x84n\x9d\xff\x00\xc6h\xff'
    b'\x00\x86N\xfd\x96?\xe8\xda~\x15\x7f\xe1\x1b\xa7\x7f\xf1\x9a\xfc\x8b\xff'
    b'\x00\x82\xbb|=\xf0\x0f\xc3_\xdaK\xc3z\x17\xc3\x9f\x03\xf8\x7f\xc2'
    b'\xbal\xfe\x07\xb3\xbb\x96\xcfD\xd3!\xb1\x82I\xda\xfe\xfdZV\x8e'
    b'\x15U.U\x11K\x11\x9c"\x8e\xc2\xbf]?d\xef\xf95\x8f\x83'
    b'\x7f\xf6O\xfc=\xff\x00\xa6\xe8+\xd5h\xa2\x8a(\xa2\x8a(\xa2\x8a'
    b"(\xa2\x8a+\xf1[\xfe\x0bW\xff\x00'O\xe1o\xfb'\xf6?\xfa"
    b'q\xd4k\xf5S\xf6N\xff\x00\x93X\xf87\xff\x00d\xff\x00\xc3\xdf'
    b'\xfan\x82\xbdV\x8a(\xa2\x8a(\xa2\x8a(\xa2\x8a(\xa2\xbf\x15\xbf'
    b'\xe0\xb5\x7f\xf2t\xfe\x16\xff\x00\xb2\x7fc\xff\x00\xa7\x1dF\xbfU?'
    b'd\xef\xf95\x8f\x83\x7f\xf6O\xfc=\xff\x00\xa6\xe8+\xd5h\xa2\x8a'
    b'(\xaf\x9b|a\xe3\x8f\x8b\x9a\xf7\xc6\x9f\x17\xdb\xfc9\xf8\x90\xba\x0e'
    b"\x91\xe0x\xf4\xed\x0f\xfb'R\xd1-\xaf\xac/ui-\xbe\xdbu"
    b'<\xea\xbe]\xd3\xc5\xf6K\xfd9b\xf2\xae\xe0\xc4\xd0\xca]\x19\x06'
    b'%b\xeb\x9f\xb4Lw\xb1x\x9e\xf3\xe2\xa6\x8d\x7f\x7fa\xfe\xaf\xc3'
    b"\xb6^\x1f\x8fL\xd0\xb5\x18\xc6r\x97\r+]\xdfE3\x06`'"
    b'\x8a\xe7\xcb\x8c\xac,m\xa5\t$s\xfb\xaf\xc3\xdf\x1a\xe9_\x12\xbc'
    b'\x01\xe1\xaf\x88\xda\x15\xbd\xdc\x1ao\x8a\xb4{-n\xce+\xb4U\x9e'
    b'8.aI\xa3Y\x15Y\x948W\x00\x80\xcc3\x9c\x13\xd6\xba\n'
    b'(\xa2\x8a(\xa2\xbf\x15\xbf\xe0\xb5\x7f\xf2t\xfe\x16\xff\x00\xb2\x7fc'
    b'\xff\x00\xa7\x1dF\xbfU?d\xef\xf95\x8f\x83\x7f\xf6O\xfc=\xff'
    b'\x00\xa6\xe8+\xd5h\xa2\x8a+\x94\xf8\xb1\xe3\xaf\xf8U\xff\x00\x0b<'
    b"e\xf13\xfb/\xfbO\xfe\x11/\x0f\xea:\xef\xd8\xbc\xff\x00'\xed"
    b'_e\xb6\x92o+\xcc\xda\xdb7y{wmlg88\xc5x'
    b'\x8f\xc3\xdf\t\xc9\xe0o\x04h\xbe\x14\xb9\xd5\x1bU\xbc\xd3\xac\xe3\x8e'
    b'\xff\x00Sx\xf6K\xa9^\x91\xba\xe6\xf6PY\x89\x96y\x9aI\xa4'
    b'fffy\x19\x99\x98\x92\xc7\xa1\xa9\xff\x00c\xddcN\xd5>\x15'
    b'\xea\x90h\xf7qjV\x16\xbe1\xf1\x1c\xd6\xba\xbd\x9c\x8b6\x9f\xaa'
    b'C{\xa9M\xa8\xa4\xb6s\xa9+:F\xb7\xc2\xdeF\x1c-\xcd\xb5'
    b'\xccc>^\xe6\xf7\x1a(\xa2\x8a(\xa2\xbf\x15\xbf\xe0\xb5\x7f\xf2t'
    b'\xfe\x16\xff\x00\xb2\x7fc\xff\x00\xa7\x1dF\xbfU?d\xef\xf95\x8f'
    b'\x83\x7f\xf6O\xfc=\xff\x00\xa6\xe8+\xd5h\xa2\x8a+\xc5\x7fj\xc9'
    b'\xa4\x9f\xc1\x9e\x14\xf0\xe4\x904V:\xe7\x8et\x14\xbc\xd4\xcf\xfa\xad'
    b'4Z]\rF\x06\x93\xb6..lm\xecS,\xbf\xbd\xbe\x8b\x1b'
    b'\xdblRQ\xae\x0f\xc7\xb2jSk\xda~\x9d\xae|6\xf1\x17\x8c'
    b'|\x12\xf04\xb7\xfa_\x87\xe7\xd3\x96MFp\xd8\x16\xd7\xdfn\xba'
    b"\xb6Qe\xb7\x0c\xd1De7'1\xcd\xe5\xc0\x8f\x15\xe7\xd0\xbf\r"
    b"\xbe+x'\xe2\xd6\x9d\xa9j\x9e\x08\xbc\xd4\xa6\x8bG\xd4\x0e\x97\x7f"
    b'\x16\xa3\xa3^\xe9w\x16\xf7B\x08g\xf2\xde\x0b\xc8\xa2\x94f+\x88'
    b'\\\x1d\xbbHq\x82y\xae\xbe\x8a(\xa2\x8a(\xaf\xc5o\xf8-_'
    b'\xfc\x9d?\x85\xbf\xec\x9f\xd8\xff\x00\xe9\xc7Q\xaf\xd5O\xd9;\xfeM'
    b'c\xe0\xdf\xfd\x93\xff\x00\x0f\x7f\xe9\xba\n\xf5Z(\xa2\x8a\xa9\xabi'
    b':V\xbf\xa5^\xe8Z\xee\x99i\xa8\xe9\xba\x8d\xbc\x96\x97\x96wp'
    b'\xac\xd0\\\xc1"\x95\x92)#`U\xd1\x94\x95*A\x04\x12\r|'
    b'\xdf\xa6\xe9\xba\xb7\xc3\x1dz\xc3\xe0\xef\x8a\xb5;\x9dZh\xf4\xb9n'
    b'\xfc=\xad\xdcLf\x9fY\xd3mZ\x08ek\xb2Ie\xbd\x85\xae'
    b'-\x96f8I\xcc\xc94X/5\xbd\xb7GP|\t\xd4b\xf0'
    b'\xaf\xc5\xaf\x1d\xf8\x12\xfc~\xf7\xc6\xaf\x17\x8e4\xa9\xf9\xfd\xea\xc1i'
    b'c\xa6_[m\x00\xed\xf2\x0c\x1at\xbec\xb2\xf9\x9f\xda;QO'
    b"\x91#\x1f\x7f\xa2\x8a(\xa2\x8a+\xf1[\xfe\x0bW\xff\x00'O\xe1"
    b"o\xfb'\xf6?\xfaq\xd4k\xf5S\xf6N\xff\x00\x93X\xf87\xff"
    b'\x00d\xff\x00\xc3\xdf\xfan\x82\xbdV\x8a(\xa2\x8a\xf9\xc3\xc6\xd1\xc9'
    b'i\xfbQ\xf8\x82[\xb4hSU\xf0\x0f\x87\xd6\xc1\xa4\x1bE\xd9\xb4'
    b'\xd4u\x8f\xb5\x08\x89\xff\x00Xa\xfbe\x9f\x99\xb7;>\xd3\x06\xec'
    b'y\x89\x9dz\xe2\xbc)\xa0\xf8\xbb\xc7\x1f\xb4-\xbe\x97\xad\xf8\xc3G'
    b'\xd1l<\x15qk\xe2\xdf\x0e\xda\xdb\xe8\xb26\xa1\xa8\xdb5\xac\xb6'
    b'w[/%\xba\xf2K#\xcd<7\x11\x8b9\x04v\xf7\xf6\x8c\xb2'
    b'\xc7<\xd1\xc9\x0f\xd5\xb4QE\x14QE~+\x7f\xc1j\xff\x00\xe4'
    b'\xe9\xfc-\xff\x00d\xfe\xc7\xff\x00N:\x8d~\xaa~\xc9\xdf\xf2k'
    b'\x1f\x06\xff\x00\xec\x9f\xf8{\xff\x00M\xd0W\xaa\xd1E\x14Q\\\xcf'
    b'\xc4\x1f\x87\xda\x0f\xc4}\x04h\xba\xd3\\\xdbMm:\xde\xe9\xba\x95'
    b'\x93*^i\x97\x8a\xac\xa9sn\xec\xac\xaa\xe1]\xd4\xab+G$'
    b'rI\x14\xa9$RI\x1bx\x93\x8f\x17\xf8\x1b]\xb5\xf0g\xc4\xe9'
    b'\xf4\xdb\x8b\xcdKq\xd1\xb5\xdd6\xceKM?WeC$\x96\xc2'
    b'\x19%\x95\xad\xae\xe3Uv\xf2ZY<\xd8\x90\xcd\x136\xcb\x88\xad'
    b'b\xf1G\x80\xfc-\xe3\x19l\xaf5\xbd:A\xa8\xe9\x9eg\xf6v'
    b'\xabeu5\x8e\xa5\xa7\xf9\x81D\xbfe\xbd\xb7d\xb8\xb7\xf3\x15B'
    b'?\x95"\xefL\xa3eI\x06O\x01\xfcD\xf1\x7f\xc3_\x8a>\x1e'
    b'\xf8u\xe3\x1f\x1a_k>\x06\xf1\x1e\x9fy\x16\x9d\xa9\xebV\x12M'
    b'u\xa6j\xb1\xcfe\r\x8e\x9d.\xa7\x1e#h\xa7\x8ei\x96#x'
    b'\xads,\xf1\xed73\xc9*F>\x94\xa2\x8a(\xa2\x8a\xfcV\xff'
    b'\x00\x82\xd5\xff\x00\xc9\xd3\xf8[\xfe\xc9\xfd\x8f\xfe\x9cu\x1a\xfdT\xfd'
    b'\x93\xbf\xe4\xd6>\r\xff\x00\xd9?\xf0\xf7\xfe\x9b\xa0\xafU\xa2\x8a('
    b'\xa2\xb9\xdf\x1c\xfcC\xf0O\xc3M\x195\xef\x1dx\x92\xcbG\xb4\x9e'
    b"qij'rf\xbd\xbadfK[hW2\\\xdc8G\xd9"
    b'\x04J\xf2\xb9\x18Ec\xc5x\x17\x8f\xfco\xa8\xfcn\xf1_\x80\xae'
    b'\xfc#\xe0\xedWN\xf0\xb7\x83\xfcA6\xbbs\xacx\x82\x194\xc9'
    b'\xb5\r\xdaM\xfd\x92Eia"}\xa8m\x96\xf1\xbc\xc6\xbaK\\'
    b"\x08\xd4\xc4'Y\x03\xafOU\xb5-7N\xd6t\xeb\xad\x1fX\xb0"
    b'\xb6\xbe\xb0\xbe\x81\xed\xae\xadnbYa\x9e\x17R\xaf\x1b\xa3\x02\xac'
    b'\xac\xa4\x82\xa4\x10A \xd2\xfc;\xf1\xbf\x89\xbe\x1e\xf8\xcb\xc3\x9f\x0e'
    b'|K\xe2MO\xc5Z\x17\x8c/&\xd2\xf4;\xadE\xd2MGI'
    b'\xba\x82\xca\xe2\xec[\xcb0U7v\xadmg(\x13L^\xe9f'
    b'A\xe6Ir.\x0b[}\x01E\x14QE~+\x7f\xc1j\xff\x00'
    b'\xe4\xe9\xfc-\xff\x00d\xfe\xc7\xff\x00N:\x8d~\xaa~\xc9\xdf\xf2'
    b'k\x1f\x06\xff\x00\xec\x9f\xf8{\xff\x00M\xd0W\xaa\xd1E\x14Q^'
    b'\t\xfbC]\x7fj\xfcR\xf8M\xe0\xdf/\xca\xfb\x0c\xda\xdf\x8d~'
    b'\xd3\x9d\xdb\xfe\xc7f\xbag\xd9\xb6q\x8d\xff\x00\xdb\xdeo\x99\x93\xb7'
    b"\xec\xbbv\x9f3r>\x8a\xc8\xf1O\x89l\xfc'\xa3\x9dZ\xee\xda"
    b'\xe6\xe9\xa4\xb9\xb5\xb0\xb4\xb5\xb6\nf\xbb\xbc\xba\xb8\x8e\xde\xd6\xdd\x0b'
    b"\xb2\xa2\xb4\xb3\xcd\x14a\xa4d\x8dK\x82\xee\x8a\x19\x85\x8d'\xe0\x97"
    b'\xc4\x7f\x88\xf7ZN\xad\xf1CQ\xb6\xf0\x86\x87\xa6j\xfan\xbdi'
    b"\xe1\xcd%\xa3\xbc\xd4n'\xb2\xbb\x86\xf2\xd4_\xde\xba\x98b_2"
    b'5Ymm\xa3r\x1e R\xf9\xd1\x99\x0f\xd0\xf4QE\x14W\xe2'
    b'\xb7\xfc\x16\xaf\xfeN\x9f\xc2\xdf\xf6O\xec\x7f\xf4\xe3\xa8\xd7\xea\xa7\xec'
    b'\x9d\xff\x00&\xb1\xf0o\xfe\xc9\xff\x00\x87\xbf\xf4\xdd\x05z\xad\x14Q'
    b'E\x15\xe6\x1f\x12~\x05i\xbe5\xf1\x13|A\xf0\xe7\x8a5_\x0b'
    b'x\xcdt\xf84\xc1\xa9[\xbf\xdam.\xed`\x92y`\xb5\xbc\xb1'
    b'\x94\x98\xa5\x84Mq#\x17\x8b\xc9\xb9\xda\xce\x91\xdcD\x1d\xb3\xe6\xfa'
    b'\xae\x9b\xf1\xb7\xe1\xf34~+\xf0"\xf8\xdfM\x8c\x19\x1b^\xf0d'
    b'k\x1b\xc7\x12\x80\xd2\xbd\xc6\x93s9\xb8B\xa1\xb6\xa4vr\xdf\xcb'
    b'7\x94\xe4$l\xd1\xc2\xc9\xe1\x7f\x1ex[\xc62\xde\xd9\xe8\x9a\x8c'
    b'\x83Q\xd3<\xbf\xed\x1d*\xf6\xd6k\x1dKO\xf3\x03\x18\xbe\xd5e'
    b'p\xa9qo\xe6*\x97O65\xde\x98u\xca\x90M\xef\x12xw'
    b'G\xf1\x7f\x87u_\t\xf8\x8a\xcf\xedzV\xb5e>\x9d}o\xe6'
    b'<~u\xbc\xd1\x98\xe4M\xc8C.U\x88\xca\x90Fx \xd5o'
    b'\xd9\x97\xe3\xcf\x8d\xbcy\xe2(~\x1fj\xde#\xf0\xe7\xc4\xed2\xcf'
    b'B\x96\xf2\x7f\x88\xbe\x18\xb3\x96\xda\xc7\xed\xb0Ik\x10\xd3\xee\x923'
    b'=\x9f\xdb$Y\x9e\xe4\xf97(\xc1A\x1fe\x89<\xb9$\xfaN'
    b'\x8a(\xa2\x8a\xfcV\xff\x00\x82\xd5\xff\x00\xc9\xd3\xf8[\xfe\xc9\xfd\x8f'
    b'\xfe\x9cu\x1a\xfdT\xfd\x93\xbf\xe4\xd6>\r\xff\x00\xd9?\xf0\xf7\xfe'
    b"\x9b\xa0\xafU\xa2\x8a(\xa2\xbc\xdb\xc6\xff\x00\xb4'\xc3O\x04kW"
    b'>\x127\xfa\x87\x88|Oh\x14M\xa1xwO\x9bR\xbb\xb7\x95'
    b'\xd1^\x08\xae\xccJa\xd3\xcc\xc1\xd4\xc6\xf7\xb2A\x13\r\xcd\xbc"'
    b';/\x87j\xdf\xb5/\xc5/\x89\xba\xc5\xef\x85\xfe\x0chpY\xdd'
    b'ZK%\x8d\xee\x97\xa6\xc3k\xe2/\x11\xda\xb8\xcaJ.\xa5\x8e\xe9'
    b'4}\n\xe23\x15\xc3C\xf6\xcb\x9b\xa4\x9fn<\xaf27\xb6}'
    b'\xcf\n~\xc6\xd1\xf8\xcbU\x83\xe2G\xed=\xe2\xcf\x12\xf8\xb3\xc76'
    b'\x85\xd3Jk\x0f\x19\xea6\xd6\xfa\x14L\x86)\r\xab\xd8\xad\x82\t'
    b'g\x8f`\x99\xa2\xb6\xb7FH\xe2C\x1bH\xb3\\\xdc\xfa\x1d\xb7\xec'
    b'\x9b\xfb9,dk\xbf\ttO\x16O\x9f\x96\xf7\xc6"O\x12^'
    b'\xc6\x9d\xa2K\x9dM\xa7\x99"\x07,"W\x08\x19\xdd\x82\x86v\''
    b'\xd6\xe8\xa2\x8a(\xa2\xbf\x15\xbf\xe0\xb5\x7f\xf2t\xfe\x16\xff\x00\xb2\x7f'
    b'c\xff\x00\xa7\x1dF\xbfU?d\xef\xf95\x8f\x83\x7f\xf6O\xfc='
    b'\xff\x00\xa6\xe8+\xd5h\xa2\x8a(\xaf\x19\xd2\xbfc\xaf\xd9\xa7I\xf3'
    b'\xad\xd3\xe1N\x9f}\xa5I<\xf71h:\xad\xd5\xce\xa3\xa1\xdaM'
    b'4\xad+\xc9k\xa5\xdc\xc9%\x95\xabny6\xb40\xa1E\x92E'
    b"]\xaa\xec\xa7\xd6\xf4\x9d'J\xd04\xab-\x0bB\xd3-4\xed7"
    b'N\xb7\x8e\xd2\xce\xce\xd2\x15\x86\x0bh#P\xb1\xc5\x1cj\x02\xa2*'
    b'\x80\xa1@\x00\x00\x00\xabtQE\x14QE\x15\xf8\xad\xff\x00\x05\xab'
    b'\xff\x00\x93\xa7\xf0\xb7\xfd\x93\xfb\x1f\xfd8\xea5\xf0\x05\x14QE\x14'
    b'QE\x14QE\x14QE\x14W\xff\xd9'
)

# ===== MAIN =====
display = PicoGraphics(display=DISPLAY_INKY_PACK)
city_idx = load_city_idx()

# Show boot splash
display.set_pen(WHITE); display.clear()
display.set_pen(BLACK); display.set_font("bitmap8")
display.text("Connecting...", 10, 55, scale=1)
display.update()

if not connect_wifi():
    show_error(display, "WiFi failed")
    raise SystemExit

while True:
    try:
        # Resolve city
        preset = PRESET_CITIES[city_idx]
        if preset[0] is None:
            lat, lon, city = get_location()
        else:
            city, lat, lon = preset[0], preset[1], preset[2]
            # still need connect to fetch weather
            connect_wifi()

        data     = get_weather(lat, lon)
        cw       = data["current_weather"]
        daily    = data["daily"]

        temp     = int(cw["temperature"])
        desc     = WMO.get(int(cw["weathercode"]), "?")
        hmax     = int(daily["temperature_2m_max"][0])
        hmin     = int(daily["temperature_2m_min"][0])
        tmax     = int(daily["temperature_2m_max"][1])
        tmin     = int(daily["temperature_2m_min"][1])
        tmr_desc = WMO.get(int(daily["weathercode"][1]), "?")
        date_str = parse_time(cw.get("time", ""))
        gc.collect()

        # --- DRAW ---
        display.set_pen(WHITE); display.clear()

        # 1. UK map
        j = jpegdec.JPEG(display)
        j.open_RAM(UK_MAP)
        j.decode(MAP_X, MAP_Y)

        # 2. Mask left panel
        display.set_pen(WHITE); display.rectangle(0, 0, MAP_X, 128)

        # 3. Header — show city name + page indicator + time
        display.set_pen(BLACK); display.rectangle(0, 0, 296, 14)
        display.set_pen(WHITE); display.set_font("bitmap6")
        # City label: show preset name or auto-resolved name
        label = city[:14]
        display.text(label, 3, 4, scale=1)
        # Page indicator e.g. "2/10"
        page_str = "{}/{}".format(city_idx, len(PRESET_CITIES) - 1) if city_idx > 0 else "Auto"
        display.text(page_str, 160, 4, scale=1)
        display.text(date_str[6:] if len(date_str) > 6 else date_str, 220, 4, scale=1)

        # 4. Left: today
        display.set_pen(BLACK); display.set_font("bitmap8")
        display.text("{}C".format(temp), 4, 18, scale=3)
        display.set_font("bitmap6")
        display.text(desc, 4, 58, scale=1)
        display.text("H:{}  L:{}".format(hmax, hmin), 4, 70, scale=1)

        # 5. Left: tomorrow
        display.set_pen(BLACK); display.line(4, 84, 143, 84)
        display.set_font("bitmap8"); display.text("Tmr", 4, 90, scale=1)
        display.set_font("bitmap6")
        display.text(tmr_desc, 4, 104, scale=1)
        display.text("H:{}  L:{}".format(tmax, tmin), 4, 115, scale=1)

        # 6. Divider
        display.set_pen(BLACK); display.line(148, 14, 148, 127)

        # 7. Location dot
        if city in CITY_DOTS:
            dx, dy = CITY_DOTS[city]
        else:
            dx, dy = latlon_to_dot(lat, lon)
        display.set_pen(BLACK); display.circle(dx, dy, 5)
        display.set_pen(WHITE); display.circle(dx, dy, 2)
        display.set_pen(BLACK)

        display.line(0, 127, 295, 127)
        display.update()

    except Exception as e:
        try:
            show_error(display, e)
        except Exception:
            pass
        time.sleep(30)
        continue

    # --- BUTTON POLL (wait up to 30 min, then auto-refresh) ---
    deadline = time.time() + 1800
    while time.time() < deadline:
        btn = btn_pressed()
        if btn == 'a':
            city_idx = (city_idx - 1) % len(PRESET_CITIES)
            save_city_idx(city_idx)
            break
        elif btn == 'b':
            city_idx = (city_idx + 1) % len(PRESET_CITIES)
            save_city_idx(city_idx)
            break
        elif btn == 'c':
            break   # refresh current city
        time.sleep_ms(100)
    # loop → re-fetch and redraw
